'use strict';

/**
 * bluebird.props with native promises
 * @param {Object} props
 * @returns {Promise}
 */
module.exports.props = (props) => {
  return Promise.all(Object.keys(props).map((key) => Promise.resolve(props[key]).then((res) => ({ [key]: res }))
  ))
    .then((resolvedArray) => {
      return resolvedArray.reduce((memo, oneRes) => {
        let key = Object.keys(oneRes)[0];

        memo[key] = oneRes[key];

        return memo;
      }, {});
    });
};

/**
 * simple and easy promise timeout
 * @param  {Promise} promise
 * @param  {number} time    number of milliseconds to allow the promise to resolve
 * @return {Promise}
 */
<<<<<<< HEAD
module.exports.timeout = (promise, time) => {
  let timer = null;

  return Promise.race([
    new Promise((resolve, reject) => {
      timer = setTimeout(reject, time, new Error('Timed out!'));

      return timer;
    }),
    promise.then((value) => {
      clearTimeout(timer);

=======
module.exports.timeout = function (promise, time) {
  let timer = null;

  return Promise.race([
    new Promise(function (resolve, reject) {
      timer = setTimeout(reject, time, new Error('Timed out!'));
      return timer;
    }),
    promise.then(function (value) {
      clearTimeout(timer);
>>>>>>> 176194e3126e4771a64518b5c246d8bb060ca40c
      return value;
    })
  ]);
};
